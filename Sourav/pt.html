<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Emergency Service Directory</title>
    <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Navbar -->
  <header class="navbar">
    <div class="nav-inner">
      <div class="brand">
        <div class="logo"><img src="../assets/logo.png" alt=""></div>
        <div class="name">
          <span>Emergency Service</span>
          <small>Bangladesh</small>
        </div>
      </div>
      <div class="stats">
        <div class="stat" id="heartStat" title="Total favorites"><span>💗</span><span id="hearts">0</span></div>
        <div class="stat pill" title="Coins available"><span>🪙</span><span id="coins">100</span></div>
        <div class="stat pill" title="Total copies"><span>📋</span><span id="copies">0</span></div>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero">
    <div class="hero-inner">
      <div class="crest"><img src="../assets/logo (1).png" alt=""></div>
      <h1>Emergency Service Directory</h1>
      <p>Government Emergency Services at Your Fingertip - A project by Government of the People's Republic of Bangladesh</p>
      <small></small>
    </div>
  </section>

  <!-- Main -->
  <div class="wrapper">
    <div class="main-grid">
      <div class="cards" id="cards"></div>

      <!-- hero -->
      <aside class="history">
        <div class="history-head">
          <div class="history-title"><span>🕘</span><span>Call History</span></div>
          <button class="clear-btn" id="clearHistory">Clear</button>
        </div>
        <ul class="history-list" id="historyList"></ul>
      </aside>
    </div>
  </div>

  <script>
   
    const services = [
      { id:'nat', name:'National Emergency Number', nameBn:'National Emergency', number:'999', category:'All', emoji:'🚨' },
      { id:'pol', name:'Police Helpline Number', nameBn:'Police', number:'999', category:'Police', emoji:'👮‍♂️' },
      { id:'fire', name:'Fire Service Number', nameBn:'Fire Service', number:'999', category:'Fire', emoji:'🚒' },
      { id:'amb', name:'Ambulance Service', nameBn:'Ambulance', number:'1994-999999', category:'Health', emoji:'🚑' },
      { id:'women', name:'Women & Child Helpline', nameBn:'Women & Child Helpline', number:'109', category:'Help', emoji:'👩‍👧' },
      { id:'anti', name:'Anti-Corruption Helpline', nameBn:'Anti-Corruption', number:'106', category:'Govt.', emoji:'🏛️' },
      { id:'elec', name:'Electricity Helpline', nameBn:'Electricity Outage', number:'16216', category:'Electricity', emoji:'💡' },
      { id:'brac', name:'Brac Helpline', nameBn:'Brac', number:'16445', category:'NGO', emoji:'🤝' },
      { id:'rail', name:'Bangladesh Railway Helpline', nameBn:'Bangladesh Railway', number:'163', category:'Travel', emoji:'🚆' }
    ];

   
    let heartCount = 0;
    let copyCount = 0;
    let coins = 100;
    const history = [];

    
    const $ = sel => document.querySelector(sel);
    const $$ = sel => document.querySelectorAll(sel);

    function updateNavbar(){
      $('#hearts').textContent = heartCount;
      $('#coins').textContent = coins;
      $('#copies').textContent = copyCount;
    }

    function timeNow(){
      const d = new Date();
      const hh = String(d.getHours()).padStart(2,'0');
      const mm = String(d.getMinutes()).padStart(2,'0');
      const ss = String(d.getSeconds()).padStart(2,'0');
      return `${hh}:${mm}:${ss}`;
    }

    function addHistoryItem(service){
      const when = timeNow();
      history.push({name: service.name, number: service.number, time: when});
      const li = document.createElement('li');
      li.className = 'history-item';
      li.innerHTML = `<div><div class="name">${service.name}</div><div class="sub">${service.number}</div></div><div class="sub">${when}</div>`;
      $('#historyList').prepend(li);
    }

    function copyText(text){
      if (navigator.clipboard && navigator.clipboard.writeText) {
        return navigator.clipboard.writeText(text);
      } else {
        // Fallback
        const ta = document.createElement('textarea');
        ta.value = text; document.body.appendChild(ta); ta.select();
        try{ document.execCommand('copy'); }catch(e){}
        document.body.removeChild(ta);
        return Promise.resolve();
      }
    }

    //  Render Cards
    function renderCards(){
      const wrap = $('#cards');
      wrap.innerHTML = '';
      services.slice(0,9).forEach(s => {
        const card = document.createElement('article');
        card.className = 'card';
        card.dataset.id = s.id;
        card.innerHTML = `
          <div class="card-top">
            <div class="icon" aria-hidden="true">${s.emoji}</div>
            <button class="heart-btn" aria-label="Add to favorites" title="Add to favorites">❤</button>
          </div>
          <h3>${s.name}</h3>
          <p class="subtitle">${s.nameBn}</p>
          <div class="big-number">${s.number}</div>
          <div class="badges"><span class="badge">${s.category}</span></div>
          <div class="card-actions">
            <button class="btn copy" data-action="copy"><span>📋</span><span>Copy</span></button>
            <button class="btn call" data-action="call"><span>📞</span><span>Call</span></button>
          </div>
        `;
        wrap.appendChild(card);
      });
    }

    // Event 
    function wireEvents(){
      Heart/Favorite
      $('#cards').addEventListener('click', (e)=>{
        const heart = e.target.closest('.heart-btn');
        if(heart){
          if(!heart.classList.contains('active')){
            heart.classList.add('active');
            heartCount += 1; updateNavbar();
          }
          return;
        }
        const btn = e.target.closest('.btn');
        if(!btn) return;
        const card = e.target.closest('.card');
        const id = card.dataset.id;
        const service = services.find(x=>x.id===id);
        if(btn.dataset.action==='copy'){
          copyText(service.number).then(()=>{
            copyCount += 1; updateNavbar();
            alert(`Number copied: ${service.name} — ${service.number}`);
          });
        }
        if(btn.dataset.action==='call'){
          if(coins < 20){
            alert('Not enough coins to make a call. You need 20 coins.');
            return;
          }
          alert(`Calling ${service.name} at ${service.number}...`);
          coins -= 20; updateNavbar();
          addHistoryItem(service);
        }
      });

      // Clear History
      $('#clearHistory').addEventListener('click', ()=>{
        history.length = 0;
        $('#historyList').innerHTML = '';
      });
    }

    // Init 
    renderCards();
    wireEvents();
    updateNavbar();
  </script>
</body>
</html>
